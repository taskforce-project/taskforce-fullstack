# ===============================
# ENVIRONNEMENT DÃ‰VELOPPEMENT
# ===============================
spring:
  # Database Configuration
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:taskforce-db}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD:PostgreSQLP54!}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 30000

  # JPA Development Settings
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:validate}
    properties:
      hibernate:
        format_sql: true

  # Flyway Development
  flyway:
    enabled: true
    clean-disabled: false
    validate-on-migrate: false
    baseline-on-migrate: true

  # Security Configuration
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${KEYCLOAK_URL:http://localhost:8180}/realms/${KEYCLOAK_REALM:taskforce-dev}
          jwk-set-uri: ${KEYCLOAK_URL:http://localhost:8180}/realms/${KEYCLOAK_REALM:taskforce-dev}/protocol/openid-connect/certs
      client:
        registration:
          keycloak:
            client-id: ${KEYCLOAK_CLIENT_ID:taskforce-api}
            client-secret: ${KEYCLOAK_CLIENT_SECRET:dev-secret}
            authorization-grant-type: authorization_code
            scope: openid,profile,email
        provider:
          keycloak:
            issuer-uri: ${KEYCLOAK_URL:http://localhost:8180}/realms/${KEYCLOAK_REALM:taskforce-dev}
  web:
    error:
      include-stacktrace: always

# CORS Configuration
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173}
  allowed-methods: GET,POST,PUT,DELETE,PATCH,OPTIONS
  allowed-headers: "*"
  allow-credentials: true
  max-age: 3600

# Keycloak Configuration
keycloak:
  url: ${KEYCLOAK_URL:http://localhost:8180}
  realm: ${KEYCLOAK_REALM:taskforce-dev}
  client-id: ${KEYCLOAK_CLIENT_ID:taskforce-api}
  client-secret: ${KEYCLOAK_CLIENT_SECRET:dev-secret}
  admin:
    username: ${KEYCLOAK_ADMIN_USERNAME:admin}
    password: ${KEYCLOAK_ADMIN_PASSWORD:admin}
    client-id: ${KEYCLOAK_ADMIN_CLIENT_ID:admin-cli}

# Stripe Configuration
stripe:
  api-key: ${STRIPE_API_KEY:sk_test_your_stripe_key_here}
  publishable-key: ${STRIPE_PUBLISHABLE_KEY:pk_test_your_publishable_key_here}
  webhook-secret: ${STRIPE_WEBHOOK_SECRET:whsec_your_webhook_secret_here}
  plans:
    premium:
      price-id: ${STRIPE_PREMIUM_PRICE_ID:price_premium_test}
    enterprise:
      price-id: ${STRIPE_ENTERPRISE_PRICE_ID:price_enterprise_test}
  checkout:
    success-url: ${STRIPE_SUCCESS_URL:http://localhost:3000/payment/success}
    cancel-url: ${STRIPE_CANCEL_URL:http://localhost:3000/payment/cancel}

  # Email Configuration (Mailtrap for development)
  mail:
    host: ${MAIL_HOST:sandbox.smtp.mailtrap.io}
    port: ${MAIL_PORT:2525}
    username: ${MAIL_USERNAME:your_mailtrap_username}
    password: ${MAIL_PASSWORD:your_mailtrap_password}
    from: ${MAIL_FROM:noreply@taskforce.com}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
        debug: true
  
  web:
    error:
      include-stacktrace: always

# Application Configuration
app:
  name: ${APP_NAME:TaskForce}
  url: ${APP_URL:http://localhost:3000}
  frontend-url: ${FRONTEND_URL:http://localhost:3000}

# JWT Configuration
jwt:
  secret: ${JWT_SECRET:myVerySecretKeyForJWTTokenGenerationThatIsLongEnoughToBeSecure256Bits}
  access-token:
    expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:3600}  # 1 heure en secondes
  refresh-token:
    expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:2592000}  # 30 jours en secondes

# OTP Configuration
otp:
  expiration-minutes: ${OTP_EXPIRATION_MINUTES:15}
  length: ${OTP_LENGTH:6}
  max-attempts: ${OTP_MAX_ATTEMPTS:5}
  max-requests-per-hour: ${OTP_MAX_REQUESTS_PER_HOUR:5}

# Logging Configuration
logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:INFO}
    com.taskforce: ${LOGGING_LEVEL_COM_TASKFORCE:DEBUG}
    org.springframework.web: ${LOGGING_LEVEL_SPRING_WEB:DEBUG}
    org.springframework.security: DEBUG
    org.hibernate.SQL: ${LOGGING_LEVEL_HIBERNATE_SQL:DEBUG}
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.flywaydb: DEBUG

# Server Configuration
server:
  port: ${SERVER_PORT:8081}

